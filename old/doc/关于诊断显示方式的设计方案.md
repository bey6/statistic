# 关于诊断显示方式的设计方案

介于诊断不可以汇总在一个列中的讨论结果，考虑还是将诊断拆开显示，但是由于诊断本身是以数组的方式存储的，所以在进行数据展示时，需要进行行转列，每页 50 条数据的情况下行转列不会太消耗性能。

那么，下面进行功能实现方面的分析。

考虑当输出列存在如下字段时：

- 诊断
  - 协和
    - 类目
    - 亚目
    - 细目
  - 北京
    - 类目
    - 亚目
    - 细目
- 手术
  - 协和
  - 北京
- 操作

需要在每次页面输出时，根据对应的诊断/手术/操作进行排序，按照其 length 从大到小排序并且取第一位的 length 数。根据该 length 数循环，为页面列表绑定的列名数组动态添加字段，添加规则为：

1. 主 xx
2. 2 xx
3. 3 xx
4. 4 xx
5. ...
6. n xx

同时为每行数据添加同样的字段，同时将值赋上去。需要注意的是，基本上诊断这种列表在显示时都是编码和文字描述同时输出的，所以在显示时需要拼接显示。

举个例子，以诊断为例，下面是希望看到的列表结果：

| 序号 | 病案号  | 年龄 | 出院时间            | 主协和诊断                  | 2 协和诊断                | 3 协和诊断                  | 4 协和诊断              |
| ---- | ------- | ---- | ------------------- | --------------------------- | ------------------------- | --------------------------- | ----------------------- |
| 1    | w295047 | 17   | 2019-07-31 10:19:19 | 乳腺交界恶性肿瘤（D48.601） |                           |                             |                         |
| 2    | w289994 | 65   | 2019-01-07 09:30:04 | 腮腺良性肿瘤（D11.003）     | 皮脂囊肿（L72.101）       | 高血压（I10 04）            | 阑尾术后 （Z98.844）    |
| 3    | w289991 | 29   | 2019-01-04 09:39:43 | 颌下腺良性肿瘤（D11.001）   |                           |                             |                         |
| 4    | w289988 | 23   | 2019-01-03 15:28:53 | 乳房良性肿瘤（D24 01）      |                           |                             |                         |
| 5    | w289986 | 28   | 2018-12-31 08:36:16 | 颌含牙囊肿（K09.001）       | 阻生齿（K01.101）         |                             |                         |
| 6    | w289946 | 52   | 2019-03-07 09:36:35 | 胃息肉（K31.701）           | 胃炎（K29.702）           |                             |                         |
| 7    | w288336 | 39   | 2018-11-05 10:27:07 | 恶性肿瘤靶向治疗（Z51.103） | 非霍奇金淋巴瘤（C85.902） | 乙型肝炎抗原阳性（Z22.501） | 甲状腺肿物（E07.901）   |
| 8    | w288333 | 36   | 2018-11-11 10:26:55 | 后天性歪鼻（M95.003）       | 陈旧性鼻骨骨折（T90.202） | 鼻中隔偏曲（J34.201）       | 慢性乙型肝炎（B18.102） |
| 9    | w288309 | 53   | 2018-11-06 09:02:59 | 皮肤肿物（R22.901）         |                           |                             |                         |
| 10   | w287757 | 21   | 2018-11-30 08:51:38 | 瘢痕疙瘩（L91.001）         |                           |                             |                         |

如果是针对主诊断的检索就无需动态添加列了，因为主诊断就是一个单独的字段对象而不是一个数组。
