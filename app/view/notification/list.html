{% extends "../parent.html" %} {% block header %} {% endblock %} {% block
content %}
<div style="margin: 8px 0">
    <label for="searchId" style="margin: 0 8px 0 0">检索编号</label
    ><input
        type="text"
        id="searchId"
        placeholder="输入检索编号"
        class="form-control form-control-sm"
        style="width: 256px; display: inline-block"
    />
</div>

<table class="table table-sm table-bordered table-hover">
    <thead>
        <tr>
            <th scope="col" width="50" style="text-align: center">序号</th>
            <th scope="col">检索编号</th>
            <th scope="col">任务描述</th>
            <th scope="col">创建时间</th>
            <th scope="col" width="100">完成状态</th>
            <th scope="col" width="100">操作</th>
        </tr>
    </thead>
    <tbody>
        {% for task in tasks %}
        <tr>
            <th scope="row" width="50" style="text-align: center">1</th>
            <td>{{task.SearchId}}</td>
            <td>{{task.Name}}</td>
            <td>{{task.CreateDate}}</td>
            {% if task.Status === 'completed' %}
            <td><span class="badge badge-success">{{task.Status}}</span></td>
            {% elif task.Status === 'running' %}
            <td><span class="badge badge-warning">{{task.Status}}</span></td>
            {% else %}
            <td><span class="badge badge-danger">{{task.Status}}</span></td>
            {% endif %}
            <td><a href="/query/result?id={{task.SearchId}}">查看</a></td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<nav aria-label="Page navigation example">
    <ul
        class="pagination pagination-sm justify-content-end"
        style="text-align: center"
    >
        <li class="page-item">
            <a class="page-link" href="#" tabindex="-1" aria-disabled="true"
                >上一页</a
            >
        </li>
        {% for p in pages %} {% if page === p %}
        <li class="page-item active">{% else %}</li>
        <li class="page-item">
            {% endif %}
            <a class="page-link" href="?page={{p}}">{{ p }}</a>
        </li>
        {% endfor %}

        <li class="page-item">
            <a class="page-link" href="#">下一页</a>
        </li>
    </ul>
</nav>

<pre>
    1. 将检索编号作为文件名称保存在 /search_task 目录下
    2. 每一笔检索任务在 sqlserver 中保存一份检索任务
    3. 每周清理一次检索任务, 主要是 /search_task 中的内容
    4. 前端应该有一个检索完成的消息通知
    5. 考虑使用一个轮训来不停的检测是否存在已经完成的 search_task, 如果有新完成的并且未查看过的 search_task, 则提示
</pre>
{% endblock %}
