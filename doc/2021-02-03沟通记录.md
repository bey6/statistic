# 2021 年 2 月 3 日沟通记录

- 基础数据的准确性还是需要进一步处理、清洗
- 诊断不可以搞到一个列里，还是应该保持一列一个诊断，空诊断全部放在最后
- 可以不要联合分组，全部由分组来替换，计数、求和什么的再单独添加
- 所有录入系统录入的条件都应该是检索项，并且也都是输出项
- 类目、亚目确实需要，并且需要码和名称（见白雪邮件）
- 可以先把检索功能搞出来，然后上一版，像顺位表什么的可以先提供一个按钮什么的支持
- 协和数据正式系统的文档总数为：1570974（157 万）
- 新增了 icd-11 字段，协和、北京编码目前全部都是 icd-10，如果不是 icd-10 就需要用脚本跑成 icd-10
- 异次病发默认不检索同一次住院满足给定诊断的数据信息，但是要给一个选项，勾选后就支持带出

## 协和现场性能测试

文档数 `http://10.160.12.34:9200/_cat/count/mr5?v`，结果：

```bash
epoch      timestamp count
1612338422 07:47:02  1570974
```

总数仅有 157 万，并没有初期预测的量级——200 万以上；那么基于已有的配置直接接入 FSA 系统，数据预热段检索时间在 3~6 秒内完成，预热结束后简单检索的查询性能在 8~1000 毫秒内可完成。

这里有一个实际的案例，检索 2000-01-01 以后出院的患者数据的类目费用顺位表基本上可以在几十毫秒内完成。

## 问题

- 使用“包含”运算关系时，总数不对
- 页码计算错误，无法动态渲染页码
